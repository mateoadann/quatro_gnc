{% extends "base.html" %}

{% block content %}
<section class="hero">
  <div>
    <h1>Dashboard general</h1>
    <p>Resumen de actividad reciente.</p>
  </div>
</section>

<section class="grid">
  <div class="card">
    <h2>Images recientes</h2>
    <table>
      <thead>
        <tr>
          <th>Archivo</th>
          <th>Imagenes</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody>
        {% for job in img_jobs %}
        {% set status_labels = {
          "queued": "En cola",
          "processing": "Procesando",
          "pending": "En cola",
          "done": "Completado",
          "error": "Error"
        } %}
        <tr>
          <td>{{ job.filename }}</td>
          <td>{{ job.page_count }}</td>
          <td><span class="badge {{ job.status }}">{{ status_labels.get(job.status, job.status) }}</span></td>
        </tr>
        {% else %}
        <tr>
          <td colspan="3" class="muted">Sin trabajos aun.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="card">
    <h2>Proceso Enargas recientes</h2>
    <table>
      <thead>
        <tr>
          <th>Patente</th>
          <th>Estado</th>
          <th>Resultado</th>
        </tr>
      </thead>
      <tbody>
        {% for proceso in procesos %}
        <tr>
          <td>{{ proceso.patente }}</td>
          <td><span class="badge {{ proceso.estado|replace(' ', '-') }}">{{ proceso.estado }}</span></td>
          <td>{{ proceso.resultado or "-" }}</td>
        </tr>
        {% else %}
        <tr>
          <td colspan="3" class="muted">Sin ejecuciones aun.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% endblock %}
