<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ workspace_name }} Dashboard</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='tanque-gas.png') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
  </head>
  <body>
    <div class="bg-orbit"></div>
    <div class="page">
      {% if current_user.is_authenticated %}
      <header class="topbar">
        <a class="brand" href="{{ url_for('main.dashboard') }}">{{ workspace_name }}</a>
        <nav class="nav-links">
          <a href="{{ url_for('main.img_to_pdf') }}" class="{% if request.endpoint == 'main.img_to_pdf' %}active{% endif %}">
            IMG_to_PDF
          </a>
          <a href="{{ url_for('main.rpa_enargas') }}" class="{% if request.endpoint == 'main.rpa_enargas' %}active{% endif %}">
            RPA_Enargas
          </a>
          {% if current_user.role == 'admin' %}
          <a href="{{ url_for('main.control_panel') }}" class="{% if request.endpoint == 'main.control_panel' %}active{% endif %}">
            Panel de control
          </a>
          {% endif %}
        </nav>
        <div class="user-area">
          <span class="user-label">
            {% if current_user.first_name or current_user.last_name %}
              {{ ((current_user.first_name or '') ~ ' ' ~ (current_user.last_name or '')) | trim }}
            {% else %}
              {{ current_user.username }}
            {% endif %}
          </span>
          <a href="{{ url_for('main.settings') }}" class="ghost-btn">Usuario</a>
          <a href="{{ url_for('auth.logout') }}" class="ghost-btn">Cerrar sesion</a>
        </div>
      </header>
      {% else %}
      <header class="topbar auth">
        <span class="brand">{{ workspace_name }}</span>
      </header>
      {% endif %}

      <main class="content">
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="flash-stack">
              {% for category, message in messages %}
                <div class="flash {{ category }}">
                  <span class="flash__text">{{ message }}</span>
                  <button class="flash__close" type="button" aria-label="Cerrar">Ã—</button>
                </div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
      </main>
    </div>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
  </body>
</html>
